# PA2-5 Temperature

1. ##### 使用数据结构与算法的构思、原理和实现要点。

    这个题要求实现：离线查询矩形区域内所有点的值的极大和极小。

    所以其实可以有很多数据结构可供选择。

    我们知道线段树套线段树的查询时间复杂度是：$O(log^2(N))$

    而2-Dimension Tree的时间复杂度是：$O(\sqrt N)$

    但是对于这个题来说实际上$\sqrt N$ 的时间复杂度已经足够，真正需要注意的是存储空间的限制。

    线段树套线段树的空间复杂度是：$O(N log^2 (N))$

    而2-Dimension Tree的空间复杂度是： $O(N )$

    而线段树套线段树实现时空间复杂度很容易写超，需要一些优化，因此我们选择了KD Tree。

    KD Tree的实现基本思路是按照课堂PPT写的，矩形查询的基本思路就是当当前矩阵属于查询矩形时就报告结果，否则就继续查询左右儿子，特别的，当当前节点不能使结果改变时（即最大值比已经找到的最大值还要小，最小值比已经找到的最小值还要大），应及时剪枝。

    以及关于`n_thelement`函数的实现，因为我们不能用STL，所以需要自己实现，需要注意要剪枝，来将$O(Nlog(N))$的复杂度优化至$O(N)$。

2. ##### 完成过程中遇到的问题，排除问题的主要过程、使用的方法和技巧，以及参考资料。

    一开始我查阅了很多树套树的资料，但实现遇到了困难，并且听说对于这个题树套树很难优化，因此改用KDTree，实现之后经过简单调试发现90测的15点TLE了，因此我调整维度选择（本身是交替选择）为随机选择，然后发现90测的15点好了，13点TLE了。这时室友提醒我可以尝试利用方差选择维度，修改之后跑的飞快，这也与我的想象有点相反，现在看来应该是算方差产生的消耗远小于使树尽量平衡带来的收益。

3. ##### 时间和空间复杂度的估算。

    见1。

4. ##### （可选）介绍理论分析与实测效果的吻合程度，不吻合时进一步解释原因。

5. ##### （可选）所用方法的特别、新颖或创新之处。